<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>NTRUEncrypt - weyung</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#ffffff"><meta name="application-name" content="weyung&#039;s blog"><meta name="msapplication-TileImage" content="/img/icon.svg"><meta name="msapplication-TileColor" content="#ffffff"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="weyung&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="1061x1061" href="/img/icon.svg"><link rel="canonical" href="https://blog.weyung.cc/2022/04/11/NTRUEncrypt/"><link rel="alternate" href="/atom.xml" title="weyung" type="application/atom+xml"><link rel="icon" href="/images/wy.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/wy.png" alt="weyung" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives/">归档</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/links/">友链</a><a class="navbar-item" href="/about/">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-04-10T16:26:00.000Z" title="4/11/2022, 12:26:00 AM">2022-04-11</time>发表</span><span class="level-item"><time dateTime="2024-06-26T11:54:30.209Z" title="6/26/2024, 7:54:30 PM">2024-06-26</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span><span class="level-item">20 分钟读完 (大约2984个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">NTRUEncrypt</h1><div class="content"><p>NTRUEncrypt 公钥加密系统</p>
<span id="more"></span>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>这里基本摘自维基百科，少少枯燥，可以自行选择略读。</p>
<p>NTRUEncrypt 是一个公钥加密系统，它的安全性基于这样一个问题的困难性：在一个截断多项式环（这个翻译怪怪的）中<strong>将一个给定的多项式分解成两个系数非常小的多项式的商</strong>。<br>由于加密与解密都只涉及简单的多项式乘法，故相比于其他的加密系统， NTRUEncrypt 的<strong>效率会更高</strong>。<br>具体来说， NTRU 的操作基于截断多项式环中的对象 ${\displaystyle \ R=\mathbb {Z} [X]/(X^{N}-1)}$ 中的<strong>卷积乘法</strong>，并且环上的所有多项式的系数和次数都为不大于 $N-1$ 的整数。<br>实际上， NTRU 是一个参数化系统，每个系统由三个整数指定 $(N,p,q)$ ，其中 $N$ 代表截断环上的所有多项式的最高次为 $N-1$ ， $p$ 和 $q$ 分别代表一个小模数和一个大模数。其中 $N$ 为素数， $q$ 大于 $p$ ，且 $p$ 与 $q$ 互质。由这三个参数生成四个多项式 $\mathcal {L}_f,\mathcal {L}_g,\mathcal {L}_m \thinspace$ 和 $\mathcal {L}_r$ ，分别为私钥、公钥、消息和干扰数。</p>
<hr>
<p>看到这里，我相信懂的人都懂的，不懂的人还不懂（bushi）<br>下面从宏观和微观两方面详细解释</p>
<h2 id="公钥生成"><a href="#公钥生成" class="headerlink" title="公钥生成"></a>公钥生成</h2><p>又双叒叕来到了密码学的老 CP —— Alice 和 Bob<br><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fauthorize.zhongbi.net%2Fd%2Ffile%2Ftu%2F2018%2F12%2F27%2F0wlyvynx1dv.jpg&refer=http%3A%2F%2Fauthorize.zhongbi.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1652234696&t=c5802c1784650149a8a25e0440448985" alt="Alice&amp;Bob"></p>
<ol>
<li>Bob 根据选定的 $N,p,q$ 生成最高次为 $N-1$ 的 $f$ 和 $g$ <strong>两个多项式</strong>，并且系数在 ${-1,0,1}$ 中选取（可以认为这俩是在模 $X^{N}-1$ 的剩余类中）。 $f$ 还要满足<strong>模 $q$ 和 $p$ 的逆元存在</strong>，如果不满足，那就重新生成。</li>
<li>分别计算 $f$ 模 $p$ 和模 $q$ 的逆元，即 $f_{p}$ 和 $f_{q}$ ，<strong>保留 $f$ , $f_{p}$ 及 $g$ 作为私钥，公钥 $h=pf_{q} \cdot g\ \pmod{q} $ 。</strong></li>
</ol>
<p>sagemath 代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_keys</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 基于提供的参数生成一个公私钥对</span></span><br><span class="line"><span class="string">        返回 f (私钥)和 F_p (公钥)&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 校验</span></span><br><span class="line">    <span class="keyword">if</span> validate_params():</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># 生成两个随机多项式 f 和 g ，并且非零系数小于给定的 d</span></span><br><span class="line">                f = generate_polynomial(d)</span><br><span class="line">                g = generate_polynomial(d)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 假定 q 是 2 的幂，求得 f 模 q 的逆元             </span></span><br><span class="line">                f_q = invertmodpowerof2(f,q)</span><br><span class="line">                <span class="comment"># 同样假定 p 是素数，求得 f 模 p 的逆元</span></span><br><span class="line">                f_p = invertmodprime(f,p)  </span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># 上面如果抛出异常，即逆元不存在，则重新生成</span></span><br><span class="line">                <span class="keyword">pass</span> </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 公钥 h=pf_p*g (mod q)</span></span><br><span class="line">        public_key = balancedmod(p * convolution(f_q,g),q)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 保留 f 和 f_p 作为私钥</span></span><br><span class="line">        secret_key = f,f_p</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> public_key,secret_key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Provided params are not correct. q and p should be co-prime, q should be a power of 2 considerably larger than p and p should be prime.&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><p>Alice 将消息 $m$ 转化成一个系数在 ${-1,0,1}$ 之间的多项式（比如转成二进制或三进制，二进制在这里会有些浪费），再随机生成一个系数较小（但不限于 ${-1,0,1}$ 中）的多项式 $r$ 作为干扰以掩盖消息。那么加密计算如下：<br>$$<br>    e=r \cdot h+m \pmod{q}<br>$$<br>举个栗子：<br>当取 $N=5,p=3,q=32$ 时（呃这里待更新）<br>$$<br>    f=-1+X+X^2<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_message</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 随机生成一个系数在&#123;-1,0,1&#125;中的多项式&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    result = <span class="built_in">list</span>(randrange(<span class="number">3</span>) - <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N))</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, public_key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 基于提供的公钥加密消息&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成一个随机多项式，并且非零系数小于给定的d，作为干扰以掩盖消息   </span></span><br><span class="line">    r = generate_polynomial(d)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 加密：e = r * h + m (mod q)</span></span><br><span class="line">    <span class="comment"># while performing modulo operation, balance coefficients of encrypted_message </span></span><br><span class="line">    <span class="comment"># for the integers in interval [-q/2, +q/2]</span></span><br><span class="line">    <span class="keyword">return</span> balancedmod(convolution(public_key,r) + message,q)</span><br></pre></td></tr></table></figure>

<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p>由于其他人不知道 $r$ ，所以无法直接 $m=e-rh$ ，但 Bob 拿到 $e$ 后，可以计算出<br>$$<br>\begin{equation*}<br>\begin{split}<br>    a<br>    &amp; = f \cdot e \pmod{q}\\<br>    &amp; = f \cdot (r \cdot h+m) \pmod{q}\\<br>    &amp; = f \cdot (r \cdot pf_{q} \cdot g+m) \pmod{q}\\<br>    &amp; = pr \cdot g + f \cdot m \pmod{q}<br>\end{split}<br>\end{equation*}<br>$$<br>关键部分来了，以上都是在模 $q$ 下进行，而这时忽然就变成了模 $p$<br>$$<br>b=a=f \cdot m \pmod{p} \\<br>c=f_{p} \cdot b =f_{p} \cdot f \cdot m =m \pmod{p}<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_message, secret_key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 基于提供的私钥解密密文&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 拿到私钥的两个多项式  </span></span><br><span class="line">    f,f_p = secret_key</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># a = f * e (mod p)</span></span><br><span class="line">    a = balancedmod(convolution(encrypted_message,f),q)</span><br><span class="line">     </span><br><span class="line">    <span class="comment"># c = f_p * a (mod p)</span></span><br><span class="line">    <span class="keyword">return</span> balancedmod(convolution(a,f_p),p)</span><br></pre></td></tr></table></figure>

<h2 id="函数实现"><a href="#函数实现" class="headerlink" title="函数实现"></a>函数实现</h2><p>下面从微观上解释一下上面函数的实现：</p>
<h3 id="卷积"><a href="#卷积" class="headerlink" title="卷积"></a>卷积</h3><p>多项式卷积满足公式<br>$$<br>    a(x)*b(x) = c(x) \ with \ c_k = \sum_{i+j=k \pmod} a_i b_{k-i \pmod{N}}<br>$$<br>举个栗子：<br>$$<br>    f(x)=-1+4x+x^2 \\<br>    g(x)=3-x+5x^2<br>$$<br>注意此时多项式和级数类似，采用低次项在先的书写方式<br>则<br>$$<br>    f(x)*g(x) = c(x) \pmod{3}<br>$$<br>其中<br>$$<br>c_0 = \sum_{i+j=0 \pmod{N}} f_i g_{0-i} = f_0g_0 + f_1g_2 + f_2g_1 = -1 \times 3 + 4 \times 5 + 1 \times (-1) = -3 + 20 + (-1) = 16 \\<br>c_1 = f_0g_1 + f_1g_0 + f_2g_2 = -1 \times (-1) + 4 \times 3 + 1 \times 5 = 1 + 12 + 5 = 18 \\<br>c_2 = f_0g_2 + f_1g_1 + f_2g_0 = -1 \times 5 + 4 \times (-1) + 1 \times 3 = -5 + (-4) + 3 = -6<br>$$<br>故<br>$$<br>c(x) = 16 + 18x - 6x^2<br>$$<br>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 多项式卷积运算&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^N-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="取模"><a href="#取模" class="headerlink" title="取模"></a>取模</h3><p>这里将多项式的每个系数 $f_i$ 拿出来，然后作变换 $g_i=(f_i+q/2)%q-q/2$ 再塞回去。这样每个系数都在 $[-q/2,q/2]$ 之间，这样可以保证模 $q$ 的运算。<br>比如取 $q=3$ 时，有以下映射关系：<br>$$<br>-3 \rightarrow (-3+1)%3 -1 = 0 \\<br>-2 \rightarrow (-2+1)%3 -1 = 1 \\<br>-1 \rightarrow (-1+1)%3 -1 = -1 \\<br>0 \rightarrow (0+1)%3-1 = 0 \\<br>1 \rightarrow (1+1)%3-1 = 1 \\<br>2 \rightarrow (2+1)%3-1 = -1 \\<br>3 \rightarrow (3+1)%3-1 = 0<br>$$<br>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">balancedmod</span>(<span class="params">f,q</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 多项式取模&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N))</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br></pre></td></tr></table></figure>

<h3 id="求逆元"><a href="#求逆元" class="headerlink" title="求逆元"></a>求逆元</h3><p>这也是我比较疑惑的一部分，一直不知道多项式的逆元具体怎么求，现在也看开了，随便怎么样吧，反正不是我手写（）<br>这里先变基到 $X^N-1$ 商环然后求逆元再 lift 到整环上，关于原理我至今有点异或，有缘回来补坑吧。<br>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">invertmodprime</span>(<span class="params">f,p</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 假定 p 为素数,计算一个多项式模 x^N-1 下的逆元再模 p</span></span><br><span class="line"><span class="string">        返回一个 Zx 上的多项式 h 满足 h 与 f 卷积模 p 为 1</span></span><br><span class="line"><span class="string">        不存在逆元时会抛出异常&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(x^N-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invertmodpowerof2</span>(<span class="params">f,q</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 假定 q 为 2 的幂，计算一个多项式模 x^N-1 下的逆元再模 q</span></span><br><span class="line"><span class="string">        返回一个 Zx 上的多项式 h 满足 h 与 f 卷积模 q 为 1</span></span><br><span class="line"><span class="string">        不存在逆元时会抛出异常&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)     <span class="comment"># 断言 q 是 2 的幂</span></span><br><span class="line">    h = invertmodprime(f,<span class="number">2</span>)     <span class="comment"># 首先求 f 模 2 的逆元</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = balancedmod(convolution(h,f),q)         <span class="comment"># 计算 r = h * f (mod q)</span></span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> h                         <span class="comment"># 若 h * f = 1 (mod q)，则返回 h 即为所求逆元</span></span><br><span class="line">        h = balancedmod(convolution(h,<span class="number">2</span> - r),q)     <span class="comment"># 否则，h = h * (2 - r) (mod q)</span></span><br></pre></td></tr></table></figure>

<h2 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h2><p>格约化攻击是一种非常著名的针对 NTRUEncrypt 的攻击，类似于 RSA 分解质因数。<br>当选取的 $N$ 较小时，可以构造维度较低的格分解公钥 $h$ 。</p>
<h3 id="例题-SCTF2020-Lattice"><a href="#例题-SCTF2020-Lattice" class="headerlink" title="例题 SCTF2020-Lattice"></a>例题 SCTF2020-Lattice</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b16encode</span><br><span class="line"></span><br><span class="line">Zx.&lt;x&gt; = ZZ[]</span><br><span class="line">n = <span class="number">109</span> </span><br><span class="line">q = <span class="number">2048</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">Df = <span class="number">9</span></span><br><span class="line">Dg = <span class="number">10</span></span><br><span class="line">Dr = <span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bal_mod</span>(<span class="params">f,q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_poly</span>(<span class="params">d</span>):</span><br><span class="line">    <span class="keyword">assert</span> d &lt;= n</span><br><span class="line">    result = n*[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            r = randrange(n)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> result[r]: <span class="keyword">break</span></span><br><span class="line">        result[r] = <span class="number">1</span>-<span class="number">2</span>*randrange(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mod_prime</span>(<span class="params">f,p</span>):</span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(x^n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mod_powerof2</span>(<span class="params">f,q</span>):</span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = inv_mod_prime(f,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = bal_mod(mul(g,f),q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> g</span><br><span class="line">        g = bal_mod(mul(g,<span class="number">2</span> - r),q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    f = random_poly(Df)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            fp = inv_mod_prime(f,p)</span><br><span class="line">            fq = inv_mod_powerof2(f,q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            f = random_poly(Df)</span><br><span class="line">    g = random_poly(Dg)</span><br><span class="line">    h = bal_mod(p * mul(fq,g),q)</span><br><span class="line">    pub_key = h</span><br><span class="line">    pri_key = [f,fp]</span><br><span class="line">    <span class="keyword">return</span> pub_key,pri_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m,h</span>):</span><br><span class="line">    r = random_poly(Dr)</span><br><span class="line">    e = bal_mod(mul(h,r) + m,q)</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pub_key,pri_key = keygen()</span><br><span class="line">    flag=<span class="string">b&#x27;SCTF&#123;***********&#125;&#x27;</span>[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line">    m = Zx(<span class="built_in">list</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(b16encode(flag), <span class="number">16</span>))[<span class="number">2</span>:]))</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    e = encrypt(m,pub_key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;pub_key=&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(pub_key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e=&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment"># pub_key=</span></span><br><span class="line"><span class="comment"># 510*x^108 - 840*x^107 - 926*x^106 - 717*x^105 - 374*x^104 - 986*x^103 + 488*x^102 + 119*x^101 - 247*x^100 + 34*x^99 + 751*x^98 - 44*x^97 - 257*x^96 - 749*x^95 + 648*x^94 - 280*x^93 - 585*x^92 - 347*x^91 + 357*x^90 - 451*x^89 - 15*x^88 + 638*x^87 - 624*x^86 - 458*x^85 + 216*x^84 + 36*x^83 - 199*x^82 - 655*x^81 + 258*x^80 + 845*x^79 + 490*x^78 - 272*x^77 + 279*x^76 + 101*x^75 - 580*x^74 - 461*x^73 - 614*x^72 - 171*x^71 - 1012*x^70 + 71*x^69 - 579*x^68 + 290*x^67 + 597*x^66 + 841*x^65 + 35*x^64 - 545*x^63 + 575*x^62 - 665*x^61 + 304*x^60 - 900*x^59 + 428*x^58 - 992*x^57 - 241*x^56 + 953*x^55 - 784*x^54 - 730*x^53 - 317*x^52 + 108*x^51 + 180*x^50 - 881*x^49 - 943*x^48 + 413*x^47 - 898*x^46 + 453*x^45 - 407*x^44 + 153*x^43 - 932*x^42 + 262*x^41 + 874*x^40 - 7*x^39 - 364*x^38 + 98*x^37 - 130*x^36 + 942*x^35 - 845*x^34 - 890*x^33 + 558*x^32 - 791*x^31 - 654*x^30 - 733*x^29 - 171*x^28 - 182*x^27 + 644*x^26 - 18*x^25 + 776*x^24 + 845*x^23 - 675*x^22 - 741*x^21 - 352*x^20 - 143*x^19 - 351*x^18 - 158*x^17 + 671*x^16 + 609*x^15 - 34*x^14 + 811*x^13 - 674*x^12 + 595*x^11 - 1005*x^10 + 855*x^9 + 831*x^8 + 768*x^7 + 133*x^6 - 436*x^5 + 1016*x^4 + 403*x^3 + 904*x^2 + 874*x + 248</span></span><br><span class="line"><span class="comment"># e=</span></span><br><span class="line"><span class="comment"># -453*x^108 - 304*x^107 - 380*x^106 - 7*x^105 - 657*x^104 - 988*x^103 + 219*x^102 - 167*x^101 - 473*x^100 + 63*x^99 - 60*x^98 + 1014*x^97 - 874*x^96 - 846*x^95 + 604*x^94 - 649*x^93 + 18*x^92 - 458*x^91 + 689*x^90 + 80*x^89 - 439*x^88 + 968*x^87 - 834*x^86 - 967*x^85 - 784*x^84 + 496*x^83 - 883*x^82 + 971*x^81 - 242*x^80 + 956*x^79 - 832*x^78 - 587*x^77 + 525*x^76 + 87*x^75 + 464*x^74 + 661*x^73 - 36*x^72 - 14*x^71 + 940*x^70 - 16*x^69 - 277*x^68 + 899*x^67 - 390*x^66 + 441*x^65 + 246*x^64 + 267*x^63 - 395*x^62 + 185*x^61 + 221*x^60 + 466*x^59 + 249*x^58 + 813*x^57 + 116*x^56 - 100*x^55 + 109*x^54 + 579*x^53 + 151*x^52 + 194*x^51 + 364*x^50 - 413*x^49 + 614*x^48 + 367*x^47 + 758*x^46 + 460*x^45 + 162*x^44 + 837*x^43 + 903*x^42 + 896*x^41 - 747*x^40 + 410*x^39 - 928*x^38 - 230*x^37 + 465*x^36 - 496*x^35 - 568*x^34 + 30*x^33 - 158*x^32 + 687*x^31 - 284*x^30 + 794*x^29 - 606*x^28 + 705*x^27 - 37*x^26 + 926*x^25 - 602*x^24 - 442*x^23 - 523*x^22 - 260*x^21 + 530*x^20 - 796*x^19 + 443*x^18 + 902*x^17 - 210*x^16 + 926*x^15 + 785*x^14 + 440*x^13 - 572*x^12 - 268*x^11 - 217*x^10 + 26*x^9 + 866*x^8 + 19*x^7 + 778*x^6 + 923*x^5 - 197*x^4 - 446*x^3 - 202*x^2 - 353*x - 852</span></span><br></pre></td></tr></table></figure>

<p>显然函数和上面的基本一样，只是名称相应地缩短了一下。<br>攻击方法是构造如下的一个格，然后进行规约<br>$$<br>\left(<br>\begin{array}{cccc|cccc}<br>\lambda &amp; 0 &amp; \cdots &amp; 0 &amp; h_0 &amp; h_1 &amp; \cdots &amp; h_{N-1} \\<br>0 &amp; \lambda &amp; \cdots &amp; 0 &amp; h_{N-1} &amp; h_0 &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; 0 \\<br>0 &amp; 0 &amp; \cdots &amp; \lambda &amp; h_1 &amp; h_2 &amp; \cdots &amp; h_0 \\ \hline<br>0 &amp; 0 &amp; \cdots &amp; 0 &amp; q &amp; 0 &amp; \cdots &amp; 0 \\<br>0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; q &amp; \cdots &amp; 0 \\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; q<br>\end{array}<br>\right)<br>$$<br>具体可以参考这篇 Paper: <a target="_blank" rel="noopener" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.578.5423&amp;rep=rep1&amp;type=pdf">https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.578.5423&amp;rep=rep1&amp;type=pdf</a><br>取 $\lambda=1$ ，规约后最短向量即为 $[f\enspace g]$ ，然后就可以计算私钥解密了。<br>exp 如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">start = time.time()</span><br><span class="line">Zx.&lt;x&gt; = ZZ[]</span><br><span class="line">n = <span class="number">109</span> </span><br><span class="line">q = <span class="number">2048</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">Df = <span class="number">9</span></span><br><span class="line">Dg = <span class="number">10</span></span><br><span class="line">Dr = <span class="number">11</span></span><br><span class="line">h=<span class="number">510</span>*x^<span class="number">108</span> - <span class="number">840</span>*x^<span class="number">107</span> - <span class="number">926</span>*x^<span class="number">106</span> - <span class="number">717</span>*x^<span class="number">105</span> - <span class="number">374</span>*x^<span class="number">104</span> - <span class="number">986</span>*x^<span class="number">103</span> + <span class="number">488</span>*x^<span class="number">102</span> + <span class="number">119</span>*x^<span class="number">101</span> - <span class="number">247</span>*x^<span class="number">100</span> + <span class="number">34</span>*x^<span class="number">99</span> + <span class="number">751</span>*x^<span class="number">98</span> - <span class="number">44</span>*x^<span class="number">97</span> - <span class="number">257</span>*x^<span class="number">96</span> - <span class="number">749</span>*x^<span class="number">95</span> + <span class="number">648</span>*x^<span class="number">94</span> - <span class="number">280</span>*x^<span class="number">93</span> - <span class="number">585</span>*x^<span class="number">92</span> - <span class="number">347</span>*x^<span class="number">91</span> + <span class="number">357</span>*x^<span class="number">90</span> - <span class="number">451</span>*x^<span class="number">89</span> - <span class="number">15</span>*x^<span class="number">88</span> + <span class="number">638</span>*x^<span class="number">87</span> - <span class="number">624</span>*x^<span class="number">86</span> - <span class="number">458</span>*x^<span class="number">85</span> + <span class="number">216</span>*x^<span class="number">84</span> + <span class="number">36</span>*x^<span class="number">83</span> - <span class="number">199</span>*x^<span class="number">82</span> - <span class="number">655</span>*x^<span class="number">81</span> + <span class="number">258</span>*x^<span class="number">80</span> + <span class="number">845</span>*x^<span class="number">79</span> + <span class="number">490</span>*x^<span class="number">78</span> - <span class="number">272</span>*x^<span class="number">77</span> + <span class="number">279</span>*x^<span class="number">76</span> + <span class="number">101</span>*x^<span class="number">75</span> - <span class="number">580</span>*x^<span class="number">74</span> - <span class="number">461</span>*x^<span class="number">73</span> - <span class="number">614</span>*x^<span class="number">72</span> - <span class="number">171</span>*x^<span class="number">71</span> - <span class="number">1012</span>*x^<span class="number">70</span> + <span class="number">71</span>*x^<span class="number">69</span> - <span class="number">579</span>*x^<span class="number">68</span> + <span class="number">290</span>*x^<span class="number">67</span> + <span class="number">597</span>*x^<span class="number">66</span> + <span class="number">841</span>*x^<span class="number">65</span> + <span class="number">35</span>*x^<span class="number">64</span> - <span class="number">545</span>*x^<span class="number">63</span> + <span class="number">575</span>*x^<span class="number">62</span> - <span class="number">665</span>*x^<span class="number">61</span> + <span class="number">304</span>*x^<span class="number">60</span> - <span class="number">900</span>*x^<span class="number">59</span> + <span class="number">428</span>*x^<span class="number">58</span> - <span class="number">992</span>*x^<span class="number">57</span> - <span class="number">241</span>*x^<span class="number">56</span> + <span class="number">953</span>*x^<span class="number">55</span> - <span class="number">784</span>*x^<span class="number">54</span> - <span class="number">730</span>*x^<span class="number">53</span> - <span class="number">317</span>*x^<span class="number">52</span> + <span class="number">108</span>*x^<span class="number">51</span> + <span class="number">180</span>*x^<span class="number">50</span> - <span class="number">881</span>*x^<span class="number">49</span> - <span class="number">943</span>*x^<span class="number">48</span> + <span class="number">413</span>*x^<span class="number">47</span> - <span class="number">898</span>*x^<span class="number">46</span> + <span class="number">453</span>*x^<span class="number">45</span> - <span class="number">407</span>*x^<span class="number">44</span> + <span class="number">153</span>*x^<span class="number">43</span> - <span class="number">932</span>*x^<span class="number">42</span> + <span class="number">262</span>*x^<span class="number">41</span> + <span class="number">874</span>*x^<span class="number">40</span> - <span class="number">7</span>*x^<span class="number">39</span> - <span class="number">364</span>*x^<span class="number">38</span> + <span class="number">98</span>*x^<span class="number">37</span> - <span class="number">130</span>*x^<span class="number">36</span> + <span class="number">942</span>*x^<span class="number">35</span> - <span class="number">845</span>*x^<span class="number">34</span> - <span class="number">890</span>*x^<span class="number">33</span> + <span class="number">558</span>*x^<span class="number">32</span> - <span class="number">791</span>*x^<span class="number">31</span> - <span class="number">654</span>*x^<span class="number">30</span> - <span class="number">733</span>*x^<span class="number">29</span> - <span class="number">171</span>*x^<span class="number">28</span> - <span class="number">182</span>*x^<span class="number">27</span> + <span class="number">644</span>*x^<span class="number">26</span> - <span class="number">18</span>*x^<span class="number">25</span> + <span class="number">776</span>*x^<span class="number">24</span> + <span class="number">845</span>*x^<span class="number">23</span> - <span class="number">675</span>*x^<span class="number">22</span> - <span class="number">741</span>*x^<span class="number">21</span> - <span class="number">352</span>*x^<span class="number">20</span> - <span class="number">143</span>*x^<span class="number">19</span> - <span class="number">351</span>*x^<span class="number">18</span> - <span class="number">158</span>*x^<span class="number">17</span> + <span class="number">671</span>*x^<span class="number">16</span> + <span class="number">609</span>*x^<span class="number">15</span> - <span class="number">34</span>*x^<span class="number">14</span> + <span class="number">811</span>*x^<span class="number">13</span> - <span class="number">674</span>*x^<span class="number">12</span> + <span class="number">595</span>*x^<span class="number">11</span> - <span class="number">1005</span>*x^<span class="number">10</span> + <span class="number">855</span>*x^<span class="number">9</span> + <span class="number">831</span>*x^<span class="number">8</span> + <span class="number">768</span>*x^<span class="number">7</span> + <span class="number">133</span>*x^<span class="number">6</span> - <span class="number">436</span>*x^<span class="number">5</span> + <span class="number">1016</span>*x^<span class="number">4</span> + <span class="number">403</span>*x^<span class="number">3</span> + <span class="number">904</span>*x^<span class="number">2</span> + <span class="number">874</span>*x + <span class="number">248</span></span><br><span class="line">e=-<span class="number">453</span>*x^<span class="number">108</span> - <span class="number">304</span>*x^<span class="number">107</span> - <span class="number">380</span>*x^<span class="number">106</span> - <span class="number">7</span>*x^<span class="number">105</span> - <span class="number">657</span>*x^<span class="number">104</span> - <span class="number">988</span>*x^<span class="number">103</span> + <span class="number">219</span>*x^<span class="number">102</span> - <span class="number">167</span>*x^<span class="number">101</span> - <span class="number">473</span>*x^<span class="number">100</span> + <span class="number">63</span>*x^<span class="number">99</span> - <span class="number">60</span>*x^<span class="number">98</span> + <span class="number">1014</span>*x^<span class="number">97</span> - <span class="number">874</span>*x^<span class="number">96</span> - <span class="number">846</span>*x^<span class="number">95</span> + <span class="number">604</span>*x^<span class="number">94</span> - <span class="number">649</span>*x^<span class="number">93</span> + <span class="number">18</span>*x^<span class="number">92</span> - <span class="number">458</span>*x^<span class="number">91</span> + <span class="number">689</span>*x^<span class="number">90</span> + <span class="number">80</span>*x^<span class="number">89</span> - <span class="number">439</span>*x^<span class="number">88</span> + <span class="number">968</span>*x^<span class="number">87</span> - <span class="number">834</span>*x^<span class="number">86</span> - <span class="number">967</span>*x^<span class="number">85</span> - <span class="number">784</span>*x^<span class="number">84</span> + <span class="number">496</span>*x^<span class="number">83</span> - <span class="number">883</span>*x^<span class="number">82</span> + <span class="number">971</span>*x^<span class="number">81</span> - <span class="number">242</span>*x^<span class="number">80</span> + <span class="number">956</span>*x^<span class="number">79</span> - <span class="number">832</span>*x^<span class="number">78</span> - <span class="number">587</span>*x^<span class="number">77</span> + <span class="number">525</span>*x^<span class="number">76</span> + <span class="number">87</span>*x^<span class="number">75</span> + <span class="number">464</span>*x^<span class="number">74</span> + <span class="number">661</span>*x^<span class="number">73</span> - <span class="number">36</span>*x^<span class="number">72</span> - <span class="number">14</span>*x^<span class="number">71</span> + <span class="number">940</span>*x^<span class="number">70</span> - <span class="number">16</span>*x^<span class="number">69</span> - <span class="number">277</span>*x^<span class="number">68</span> + <span class="number">899</span>*x^<span class="number">67</span> - <span class="number">390</span>*x^<span class="number">66</span> + <span class="number">441</span>*x^<span class="number">65</span> + <span class="number">246</span>*x^<span class="number">64</span> + <span class="number">267</span>*x^<span class="number">63</span> - <span class="number">395</span>*x^<span class="number">62</span> + <span class="number">185</span>*x^<span class="number">61</span> + <span class="number">221</span>*x^<span class="number">60</span> + <span class="number">466</span>*x^<span class="number">59</span> + <span class="number">249</span>*x^<span class="number">58</span> + <span class="number">813</span>*x^<span class="number">57</span> + <span class="number">116</span>*x^<span class="number">56</span> - <span class="number">100</span>*x^<span class="number">55</span> + <span class="number">109</span>*x^<span class="number">54</span> + <span class="number">579</span>*x^<span class="number">53</span> + <span class="number">151</span>*x^<span class="number">52</span> + <span class="number">194</span>*x^<span class="number">51</span> + <span class="number">364</span>*x^<span class="number">50</span> - <span class="number">413</span>*x^<span class="number">49</span> + <span class="number">614</span>*x^<span class="number">48</span> + <span class="number">367</span>*x^<span class="number">47</span> + <span class="number">758</span>*x^<span class="number">46</span> + <span class="number">460</span>*x^<span class="number">45</span> + <span class="number">162</span>*x^<span class="number">44</span> + <span class="number">837</span>*x^<span class="number">43</span> + <span class="number">903</span>*x^<span class="number">42</span> + <span class="number">896</span>*x^<span class="number">41</span> - <span class="number">747</span>*x^<span class="number">40</span> + <span class="number">410</span>*x^<span class="number">39</span> - <span class="number">928</span>*x^<span class="number">38</span> - <span class="number">230</span>*x^<span class="number">37</span> + <span class="number">465</span>*x^<span class="number">36</span> - <span class="number">496</span>*x^<span class="number">35</span> - <span class="number">568</span>*x^<span class="number">34</span> + <span class="number">30</span>*x^<span class="number">33</span> - <span class="number">158</span>*x^<span class="number">32</span> + <span class="number">687</span>*x^<span class="number">31</span> - <span class="number">284</span>*x^<span class="number">30</span> + <span class="number">794</span>*x^<span class="number">29</span> - <span class="number">606</span>*x^<span class="number">28</span> + <span class="number">705</span>*x^<span class="number">27</span> - <span class="number">37</span>*x^<span class="number">26</span> + <span class="number">926</span>*x^<span class="number">25</span> - <span class="number">602</span>*x^<span class="number">24</span> - <span class="number">442</span>*x^<span class="number">23</span> - <span class="number">523</span>*x^<span class="number">22</span> - <span class="number">260</span>*x^<span class="number">21</span> + <span class="number">530</span>*x^<span class="number">20</span> - <span class="number">796</span>*x^<span class="number">19</span> + <span class="number">443</span>*x^<span class="number">18</span> + <span class="number">902</span>*x^<span class="number">17</span> - <span class="number">210</span>*x^<span class="number">16</span> + <span class="number">926</span>*x^<span class="number">15</span> + <span class="number">785</span>*x^<span class="number">14</span> + <span class="number">440</span>*x^<span class="number">13</span> - <span class="number">572</span>*x^<span class="number">12</span> - <span class="number">268</span>*x^<span class="number">11</span> - <span class="number">217</span>*x^<span class="number">10</span> + <span class="number">26</span>*x^<span class="number">9</span> + <span class="number">866</span>*x^<span class="number">8</span> + <span class="number">19</span>*x^<span class="number">7</span> + <span class="number">778</span>*x^<span class="number">6</span> + <span class="number">923</span>*x^<span class="number">5</span> - <span class="number">197</span>*x^<span class="number">4</span> - <span class="number">446</span>*x^<span class="number">3</span> - <span class="number">202</span>*x^<span class="number">2</span> - <span class="number">353</span>*x - <span class="number">852</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^n-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">pri_key,e</span>):</span><br><span class="line">    f,fp = pri_key</span><br><span class="line">    a = bal_mod(mul(f,e),q)</span><br><span class="line">    b = bal_mod(mul(a,fp),p)</span><br><span class="line">    pt = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> b.<span class="built_in">list</span>()])</span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bal_mod</span>(<span class="params">f,q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lattice</span>(<span class="params">h,q</span>):</span><br><span class="line">    n = <span class="number">109</span></span><br><span class="line">    <span class="comment"># h = bal_mod(683*h,q)</span></span><br><span class="line">    grid = Matrix(ZZ,<span class="number">2</span>*n,<span class="number">2</span>*n)</span><br><span class="line">    cof = h.<span class="built_in">list</span>()</span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*n):</span><br><span class="line">            <span class="keyword">if</span> i&lt;n:</span><br><span class="line">                <span class="keyword">if</span> j &lt; n:</span><br><span class="line">                    <span class="keyword">if</span> i==j:</span><br><span class="line">                        grid[i,j] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    grid[i,j] = cof[(j-n-offset)%n]</span><br><span class="line">            <span class="keyword">elif</span> j&gt;=n <span class="keyword">and</span> i==j:</span><br><span class="line">                grid[i,j] = q</span><br><span class="line">        offset += <span class="number">1</span></span><br><span class="line">    GL = grid.BKZ()</span><br><span class="line">    <span class="keyword">return</span> GL,grid</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mod_prime</span>(<span class="params">f,p</span>):</span><br><span class="line">    T = Zx.change_ring(Integers(p)).quotient(x^n-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br><span class="line"></span><br><span class="line">GL,grid = lattice(h,q)</span><br><span class="line">SVP = <span class="built_in">list</span>(GL[<span class="number">0</span>])</span><br><span class="line">f = Zx(SVP[:n])</span><br><span class="line">g = Zx(SVP[-n:])</span><br><span class="line">a = bal_mod(mul(f,e),q)</span><br><span class="line">fp = inv_mod_prime(f,p)</span><br><span class="line">pv = (f,fp)</span><br><span class="line"><span class="built_in">print</span>(decrypt(pv,e))</span><br><span class="line">flag = <span class="built_in">int</span>(decrypt(pv,e)+<span class="string">&#x27;0&#x27;</span>*<span class="number">6</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(end-start)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="勘误"><a href="#勘误" class="headerlink" title="勘误"></a>勘误</h2><p>维基百科中说 $m$ 转化成系数在 $[-p/2,p/2]$ 间多项式，实际应为 ${-1,0,1}$ 间。<br>代码中加密函数原为<code>return balancedmod(convolution(public_key,p*r) + message,q)</code>，一般版本中的公钥是没乘 $p$ 的，在加密中才乘，但这里公钥已经乘过 $p$ 了，就可以删去。实测不删去也可正常解密，推测应该是在后面取模时消去了，读者可自行推导。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/NTRUEncrypt">https://en.wikipedia.org/wiki/NTRUEncrypt</a><br><a target="_blank" rel="noopener" href="https://github.com/joannawetesko/NTRU-cryptosystem/blob/master/NTRU.sage">https://github.com/joannawetesko/NTRU-cryptosystem/blob/master/NTRU.sage</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_36742186/article/details/83689529">https://blog.csdn.net/sinat_36742186/article/details/83689529</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>NTRUEncrypt</p><p><a href="https://blog.weyung.cc/2022/04/11/NTRUEncrypt/">https://blog.weyung.cc/2022/04/11/NTRUEncrypt/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>未央</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-04-11</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-06-26</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="CC BY-NC 4.0" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh"><i class="icon fab fa-creative-commons"></i><i class="icon fab fa-creative-commons-by"></i><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Crypto/">Crypto</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%95%B0%E5%AD%A6/">数学</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0/">抽象代数</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%A0%BC/">格</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechatpay.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/05/27/%E5%B0%8F%20CRT%20%E6%8C%87%E6%95%B0%E9%9D%9E%E5%B9%B3%E8%A1%A1%20RSA%20%E7%9A%84%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90%E8%AE%BA%E6%96%87%E5%88%86%E6%9E%90/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">小 CRT 指数非平衡 RSA 的密码分析论文分析</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/04/06/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-item">汇编学习笔记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.16/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread',
            appId: "naquiv8kljfmeFx6t9aSTTWn-9Nh9j0Va",
            appKey: "fneElOQzdSRFC3p43Bd4J69D",
            placeholder: "说点什么吧",
            avatar: "mm",
            avatarForce: false,
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "zh-CN",
            visitor: false,
            highlight: true,
            recordIP: false,
            
            
            
            enableQQ: false,
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/wy.png" alt="未央"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">未央</p><p class="is-size-6 is-block">写一些和我一样菜也能看懂的文章</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">43</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">40</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="GitHub" href="https://github.com/weyung"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Telegram" href="https://t.me/we_yung"><i class="fab fa-telegram"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#简介"><span class="level-left"><span class="level-item">1</span><span class="level-item">简介</span></span></a></li><li><a class="level is-mobile" href="#公钥生成"><span class="level-left"><span class="level-item">2</span><span class="level-item">公钥生成</span></span></a></li><li><a class="level is-mobile" href="#加密"><span class="level-left"><span class="level-item">3</span><span class="level-item">加密</span></span></a></li><li><a class="level is-mobile" href="#解密"><span class="level-left"><span class="level-item">4</span><span class="level-item">解密</span></span></a></li><li><a class="level is-mobile" href="#函数实现"><span class="level-left"><span class="level-item">5</span><span class="level-item">函数实现</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#卷积"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">卷积</span></span></a></li><li><a class="level is-mobile" href="#取模"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">取模</span></span></a></li><li><a class="level is-mobile" href="#求逆元"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">求逆元</span></span></a></li></ul></li><li><a class="level is-mobile" href="#攻击"><span class="level-left"><span class="level-item">6</span><span class="level-item">攻击</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#例题-SCTF2020-Lattice"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">例题 SCTF2020-Lattice</span></span></a></li></ul></li><li><a class="level is-mobile" href="#勘误"><span class="level-left"><span class="level-item">7</span><span class="level-item">勘误</span></span></a></li><li><a class="level is-mobile" href="#参考"><span class="level-left"><span class="level-item">8</span><span class="level-item">参考</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-20T17:53:00.000Z">2024-06-21</time></p><p class="title"><a href="/2024/06/21/%E4%BF%A1%E6%81%AF%E8%AE%BA%E7%AC%94%E8%AE%B0/">信息论笔记</a></p><p class="categories"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-20T17:53:00.000Z">2024-06-21</time></p><p class="title"><a href="/2024/06/21/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/">信号与系统笔记</a></p><p class="categories"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-05T07:52:00.000Z">2024-06-05</time></p><p class="title"><a href="/2024/06/05/2022%20CISCN%20-%20ezpop/">2022 CISCN - ezpop</a></p><p class="categories"><a href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-04T18:10:00.000Z">2024-06-05</time></p><p class="title"><a href="/2024/06/05/%E8%AE%A1%E7%BB%84%E7%AC%94%E8%AE%B0/">计组笔记</a></p><p class="categories"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-04T05:52:00.000Z">2024-06-04</time></p><p class="title"><a href="/2024/06/04/HackTheBox%20%E7%AC%94%E8%AE%B0%20-%202/">HackTheBox 笔记 - 2</a></p><p class="categories"><a href="/categories/%E6%B8%97%E9%80%8F/">渗透</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/C%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">C语言</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">学习</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E7%8E%A9%E6%84%8F/"><span class="level-start"><span class="level-item">小玩意</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">小项目</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%B8%97%E9%80%8F/"><span class="level-start"><span class="level-item">渗透</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><span class="level-start"><span class="level-item">环境搭建</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%9F%E6%B4%BB/"><span class="level-start"><span class="level-item">生活</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/"><span class="level-start"><span class="level-item">题解</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVP/"><span class="tag">CVP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Code-server/"><span class="tag">Code-server</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Crypto/"><span class="tag">Crypto</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPT/"><span class="tag">GPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nginx/"><span class="tag">Nginx</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSL/"><span class="tag">SSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VSCode/"><span class="tag">VSCode</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WSL/"><span class="tag">WSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web/"><span class="tag">Web</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/"><span class="tag">二进制安全</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%90%86/"><span class="tag">代理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/"><span class="tag">信号与系统笔记</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%A1%E6%81%AF%E8%AE%BA/"><span class="tag">信息论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%89%8D%E7%AB%AF/"><span class="tag">前端</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%8D%E5%8F%98%E5%87%BD%E6%95%B0/"><span class="tag">复变函数</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0/"><span class="tag">学习</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0/"><span class="tag">抽象代数</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%82%E8%B0%88/"><span class="tag">杂谈</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9D%90%E6%96%99%E5%8A%9B%E5%AD%A6/"><span class="tag">材料力学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%BC/"><span class="tag">格</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96/"><span class="tag">汇编</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F/"><span class="tag">渗透</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%9F%E6%B4%BB/"><span class="tag">生活</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E5%BD%B1/"><span class="tag">电影</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/"><span class="tag">计算机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="tag">计算机网络</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%BB%84/"><span class="tag">计组</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BA%E6%96%87/"><span class="tag">论文</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/"><span class="tag">面试</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%AB%98%E6%95%B0/"><span class="tag">高数</span><span class="tag">3</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">六月 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">四月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/wy.png" alt="weyung" height="28"></a><p class="is-size-7"><span>&copy; 2024 未央</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="CC BY-NC 4.0" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh"><i></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>